{% load i18n %}{% load setting %} 
{% setting MEDIA_URL as MEDIA_URL %}

{% if task.state = 'FINISHED' %}
    <a href="{{ MEDIA_URL }}PDF/{{task.result.file}}" target="_blank">
        {% trans "Télécharger" %}
    </a><br/>
    {% if task.hash != songbook.hash %}
        <small>
            <a href="{% url 'render_songbook' id=songbook.id slug=songbook.slug %}?layout={{layout.id}}">
                {% trans "Regénérer" %}
            </a>
        </small>
    {% else %}
        &nbsp;
    {% endif %}
{% elif task.state = 'QUEUED' %}
    <small class="update-me task" data-task="{{ task.id }}">
        {% trans "Génération en attente..." %}
    </small>
{% elif task.state = 'IN_PROCESS' %}
    <small class="update-me task" data-task="{{ task.id }}">
        {% trans "Génération en cours..." %}
    </small>
{% else %}
    {% if not task %}
        <a href="{% url 'render_songbook' id=songbook.id slug=songbook.slug %}?layout={{layout.id}}">
            {% trans "Générer" %}
        </a><br/>&nbsp;
    {% else %}
        <a href="{% url 'render_songbook' id=songbook.id slug=songbook.slug %}?layout={{layout.id}}">
            {% trans "Relancer la génération" %}
        </a><br/>
        {% if user.is_superuser %}
            <small>
                <a href="{% url 'admin:generator_task_change' task.id %}">
                    {% trans "Voir dans Django administration" %}
                </a>
            </small>
        {% else %}
            <small>
                {% trans "Echec de la génération" %}
            </small>
        {% endif %}
    {% endif %}
{% endif %}
